# ============================================================
# SITE MECHANIC ENVIRONMENT CONFIGURATION
# ============================================================
# Copy this file to .env and fill in your values
#
# PRODUCTION CHECKLIST:
# [x] NODE_ENV=production
# [x] JWT_SECRET set to secure random string (32+ chars)
# [x] STRIPE_SECRET_KEY set to live key (sk_live_...)
# [x] STRIPE_WEBHOOK_SECRET set to production webhook secret
# [x] CORS_ORIGIN set to your domain (not *)
# [x] APP_BASE_URL set to your production URL
# [x] DOWNLOAD_TOKEN_SECRET set to secure random string
# [x] PAYMENT_DEMO_MODE=false (or unset)
# ============================================================

# Server Configuration
PORT=3000
NODE_ENV=development
BASE_URL=http://localhost:3000

# Database
DATABASE_PATH=./data/fontscanner.db

# ============================================================
# AUTHENTICATION (REQUIRED)
# ============================================================
# IMPORTANT: This MUST be set in production! Use a long random string (32+ characters)
# Generate with: openssl rand -base64 32
JWT_SECRET=change-this-in-production-use-long-random-string-min-32-chars

# Download token secret for PDF downloads
# Generate with: openssl rand -base64 32
DOWNLOAD_TOKEN_SECRET=change-this-secret-in-production

# Stripe Payment Integration (Phase 2)
# Get these from: https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=sk_test_your_test_secret_key_here
STRIPE_PUBLISHABLE_KEY=pk_test_your_test_publishable_key_here

# Stripe Webhook Secret (get from: https://dashboard.stripe.com/webhooks)
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret_here

# Billing return URL allowlist (comma-separated hostnames). Used to validate returnUrl passed to /api/billing/create-checkout-session
# Example: BILLING_ALLOWED_RETURN_HOSTS=localhost,sitemechanic.io,www.sitemechanic.io
BILLING_ALLOWED_RETURN_HOSTS=localhost

# Stripe Price IDs (from Stripe Dashboard > Products)
# Subscriptions - Pro Plan
STRIPE_PRICE_PRO_MONTHLY=price_your_pro_monthly_20_price_id     # $20/month recurring
STRIPE_PRICE_PRO_YEARLY=price_your_pro_yearly_180_price_id      # $180/year recurring (Save 25%)
STRIPE_PRICE_DAY_PASS=price_your_day_pass_20_price_id           # $20/day recurring (auto-cancels after 1 day)

# Single Report Purchase
STRIPE_PRICE_SINGLE_REPORT=price_your_single_report_10_price_id # $10 one-time

# Legacy (deprecated, use above instead)
STRIPE_PRO_PRICE_ID=price_your_monthly_price_id
STRIPE_PRO_ANNUAL_PRICE_ID=price_your_annual_price_id
STRIPE_PRICE_SINGLE_REPORT_10=price_your_single_report_10_price_id

# Credit Packs (legacy, optional)
STRIPE_PRICE_CREDITS_PACK_5_40=price_your_credits_pack_5_price_id
STRIPE_PRICE_CREDITS_PACK_10_70=price_your_credits_pack_10_price_id
STRIPE_PRICE_CREDITS_PACK_25_150=price_your_credits_pack_25_price_id

# App Base URL (used for Stripe redirects)
APP_BASE_URL=https://sitemechanic.io

# Logging
LOG_LEVEL=INFO

# Rate Limiting
# Global rate limit (applies to all API endpoints except health checks)
RATE_LIMIT_WINDOW_MS=900000          # 15 minutes in milliseconds
RATE_LIMIT_MAX_REQUESTS=100          # Maximum requests per window per IP

# Scan endpoint rate limit (more restrictive for resource-intensive operations)
SCAN_RATE_LIMIT_WINDOW_MS=900000     # 15 minutes in milliseconds
SCAN_RATE_LIMIT_MAX_REQUESTS=20      # Maximum scans per window per IP

# Download endpoint rate limit (PDF report downloads)
DOWNLOAD_RATE_LIMIT_WINDOW_MS=900000 # 15 minutes in milliseconds
DOWNLOAD_RATE_LIMIT_MAX_REQUESTS=50  # Maximum downloads per window per IP

# Whitelisted IPs (comma-separated, optional - for admin/monitoring tools)
# RATE_LIMIT_WHITELIST=10.0.0.1,192.168.1.100

# ============================================================
# SECURITY (REQUIRED IN PRODUCTION)
# ============================================================
# CORS origin - MUST be set to your domain in production (not *)
# Examples: https://yourdomain.com or https://www.yourdomain.com
CORS_ORIGIN=*

# Payment demo mode - set to false in production
# When true, accepts test card numbers for development
PAYMENT_DEMO_MODE=true

# Puppeteer Configuration
PUPPETEER_HEADLESS=true
PUPPETEER_TIMEOUT=30000

# Report Storage
REPORTS_DIR=./reports
REPORTS_RETENTION_DAYS=7

# Performance
MAX_PAGES_TO_SCAN=10
SCAN_TIMEOUT=60000

# Error Telemetry
ERROR_TELEMETRY_ENABLED=true                   # Enable/disable error tracking
ERROR_TELEMETRY_MAX_ERRORS=1000                # Maximum errors to store in memory
ERROR_TELEMETRY_MAX_AGGREGATIONS=100           # Maximum error aggregations to track
ERROR_TELEMETRY_RETENTION_HOURS=24             # How long to keep errors (in hours)
ERROR_TELEMETRY_THRESHOLD_MINUTE=10            # Alert if > 10 errors/minute
ERROR_TELEMETRY_THRESHOLD_HOUR=100             # Alert if > 100 errors/hour
ERROR_TELEMETRY_THRESHOLD_DAY=1000             # Alert if > 1000 errors/day
